# language: zh-TW
@logistics
功能: 物流運送管理
  作為電子商務系統
  我需要管理訂單配送
  以便確保商品能正確安排運送和取消

  背景:
    假設 物流服務已啟動

  @positive @happy-path
  場景: 成功安排運送
    假設 一個有效的運送請求，交易ID為 "770e8400-e29b-41d4-a716-446655440001"
    當 發送運送安排請求
    那麼 應該收到成功的運送回應
    而且 回應應包含物流追蹤編號

  @positive @idempotent
  場景: 冪等性 - 重複運送請求返回相同結果
    假設 一個有效的運送請求，交易ID為 "770e8400-e29b-41d4-a716-446655440002"
    當 發送運送安排請求
    而且 再次發送相同的運送安排請求
    那麼 兩次運送回應應該相同
    而且 應該只安排一次運送

  @positive @rollback
  場景: 成功取消已安排的運送
    假設 一個有效的運送請求，交易ID為 "770e8400-e29b-41d4-a716-446655440003"
    當 發送運送安排請求
    而且 收到成功的運送回應
    當 發送取消運送請求
    那麼 應該收到成功的取消回應
    而且 取消訊息應為 "Shipment cancelled successfully"

  @positive @rollback-idempotent
  場景: 冪等性 - 重複取消請求返回相同結果
    假設 一個有效的運送請求，交易ID為 "770e8400-e29b-41d4-a716-446655440004"
    當 發送運送安排請求並成功
    當 發送取消運送請求
    那麼 第一次取消訊息應為 "Shipment cancelled successfully"
    當 再次發送相同的取消請求
    那麼 第二次取消訊息應為 "Shipment already cancelled"

  @negative @no-shipment
  場景: 取消不存在的運送 - 無操作
    假設 一個取消請求，交易ID為 "770e8400-e29b-41d4-a716-446655440005"
    當 發送取消請求給不存在的運送
    那麼 應該收到成功的取消回應
    而且 取消訊息應為 "No shipment to cancel"

  @negative @failure-simulation
  場景: 模擬物流公司無法配送失敗
    假設 物流服務配置為失敗模式
    假設 一個有效的運送請求，交易ID為 "770e8400-e29b-41d4-a716-446655440006"
    當 發送運送安排請求
    那麼 應該收到失敗的運送回應
    而且 失敗訊息應包含 "Carrier unavailable"
